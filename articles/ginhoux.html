<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SCORPIUS">
<title>Investigating dendritic cell maturation in dendritic cell progenitors â€¢ SCORPIUS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Investigating dendritic cell maturation in dendritic cell progenitors">
<meta property="og:description" content="SCORPIUS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SCORPIUS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/anndata.html">Running SCORPIUS on an AnnData object</a>
    <a class="dropdown-item" href="../articles/ginhoux.html">Investigating dendritic cell maturation in dendritic cell progenitors</a>
    <a class="dropdown-item" href="../articles/seurat.html">Running SCORPIUS on a Seurat object</a>
    <a class="dropdown-item" href="../articles/simulated-data.html">Trajectory inference from simulated data</a>
    <a class="dropdown-item" href="../articles/singlecellexperiment.html">Running SCORPIUS on a SingleCellExperiment object</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rcannood/SCORPIUS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Investigating dendritic cell maturation in dendritic cell progenitors</h1>
                        <h4 data-toc-skip class="author">Robrecht
Cannoodt</h4>
            
            <h4 data-toc-skip class="date">2016-01-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rcannood/SCORPIUS/blob/HEAD/vignettes/ginhoux.Rmd" class="external-link"><code>vignettes/ginhoux.Rmd</code></a></small>
      <div class="d-none name"><code>ginhoux.Rmd</code></div>
    </div>

    
    
<!-- github markdown built using 
rmarkdown::render("vignettes/ginhoux.Rmd", output_format = "github_document")
-->
<p>In this vignette, SCORPIUS is used to infer a trajectory through
dendritic cell progenitors. The <code>ginhoux</code> dataset contains
248 dendritic cell progenitors in one of three cellular cellular states:
MDP, CDP or PreDC.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rcannood/SCORPIUS" class="external-link">SCORPIUS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ginhoux</span><span class="op">)</span></span></code></pre></div>
<p>The dataset is a list containing a matrix named
<code>expression</code> and a data frame named
<code>sample_info</code>.</p>
<p><code>expression</code> was a 245-by-15752 matrix containing the
expression values of all the cells and all the genes, but this dataset
had to be reduced to 2000 genes in order to reduce the package size. See
<code><a href="../reference/ginhoux.html">?ginhoux</a></code> for more info.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ginhoux</span><span class="op">$</span><span class="va">expression</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                   Mpo  DQ688647      Ly6d   Snora31    Prtn3  DQ567485</span></span>
<span><span class="co">## SRR1558744  1.6168843  9.041883  1.616884 10.587718 8.342093  9.349044</span></span>
<span><span class="co">## SRR1558745  8.6334859 11.435542  0.000000  7.931509 9.217237 10.047680</span></span>
<span><span class="co">## SRR1558746  0.0000000 11.056615  0.000000  0.000000 9.495118  9.532252</span></span>
<span><span class="co">## SRR1558747  0.9744123 11.962396 12.902384  0.000000 0.000000 10.954714</span></span>
<span><span class="co">## SRR1558748 10.0596172 11.035344  0.000000  0.000000 9.371665 10.211225</span></span>
<span><span class="co">## SRR1558749  8.7327325  7.612738  0.000000  7.986711 9.863754  8.009253</span></span></code></pre>
<p><code>sample_info</code> is a data frame with the metadata of the
cells, containing cell types of the individual cells.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ginhoux</span><span class="op">$</span><span class="va">sample_info</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##            group_name</span></span>
<span><span class="co">## SRR1558744        CDP</span></span>
<span><span class="co">## SRR1558745        CDP</span></span>
<span><span class="co">## SRR1558746        CDP</span></span>
<span><span class="co">## SRR1558747        CDP</span></span>
<span><span class="co">## SRR1558748        CDP</span></span>
<span><span class="co">## SRR1558749        CDP</span></span></code></pre>
<p>In order to infer a trajectory through this data, SCORPIUS first
reduces the dimensionality of the dataset.</p>
<div class="section level2">
<h2 id="reduce-dimensionality-of-the-dataset">Reduce dimensionality of the dataset<a class="anchor" aria-label="anchor" href="#reduce-dimensionality-of-the-dataset"></a>
</h2>
<p>SCORPIUS uses Torgerson multi-dimensional scaling to reduce the
dataset to three dimensions. This technique attempts to place the cells
in a space such that the distance between any two points in that space
approximates the original distance between the two cells as well as
possible.</p>
<p>The distance between any two samples is defined as their correlation
distance, namely <code>1 - (cor(x, y)+1)/2</code>. The reduced space is
constructed as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expression</span> <span class="op">&lt;-</span> <span class="va">ginhoux</span><span class="op">$</span><span class="va">expression</span></span>
<span><span class="va">group_name</span> <span class="op">&lt;-</span> <span class="va">ginhoux</span><span class="op">$</span><span class="va">sample_info</span><span class="op">$</span><span class="va">group_name</span></span>
<span><span class="va">space</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reduce_dimensionality.html">reduce_dimensionality</a></span><span class="op">(</span><span class="va">expression</span>, <span class="st">"spearman"</span>, ndim <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The new space is a 245-by-3 matrix, and can be visualised with or
without colouring of the different cell types.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_trajectory_plot.html">draw_trajectory_plot</a></span><span class="op">(</span><span class="va">space</span>, progression_group <span class="op">=</span> <span class="va">group_name</span>, contour <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ginhoux_files/figure-html/show_dimred-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="inferring-a-trajectory-through-the-cells">Inferring a trajectory through the cells<a class="anchor" aria-label="anchor" href="#inferring-a-trajectory-through-the-cells"></a>
</h2>
<p>The main goal of SCORPIUS is to infer a trajectory through the cells,
and orden the cells according to the inferred timeline.</p>
<p>SCORPIUS infers a trajectory through several intermediate steps,
which are all executed as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/infer_trajectory.html">infer_trajectory</a></span><span class="op">(</span><span class="va">space</span><span class="op">)</span></span></code></pre></div>
<p>The result is a list containing the final trajectory
<code>path</code> and the inferred timeline for each sample
<code>time</code>.</p>
<p>The trajectory can be visualised with respect to the samples by
passing it to <code>draw_trajectory_plot</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_trajectory_plot.html">draw_trajectory_plot</a></span><span class="op">(</span></span>
<span>  <span class="va">space</span>, </span>
<span>  progression_group <span class="op">=</span> <span class="va">group_name</span>,</span>
<span>  path <span class="op">=</span> <span class="va">traj</span><span class="op">$</span><span class="va">path</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ginhoux_files/figure-html/plot_trajectory-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="finding-candidate-marker-genes">Finding candidate marker genes<a class="anchor" aria-label="anchor" href="#finding-candidate-marker-genes"></a>
</h2>
<p>We search for genes whose expression is seems to be a function of the
trajectory timeline that was inferred, as such genes might be good
candidate marker genes for dendritic cell maturation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gimp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gene_importances.html">gene_importances</a></span><span class="op">(</span><span class="va">expression</span>, <span class="va">traj</span><span class="op">$</span><span class="va">time</span>, num_permutations <span class="op">=</span> <span class="fl">0</span>, num_threads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">gene_sel</span> <span class="op">&lt;-</span> <span class="va">gimp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span></span>
<span><span class="va">expr_sel</span> <span class="op">&lt;-</span> <span class="va">expression</span><span class="op">[</span>,<span class="va">gene_sel</span><span class="op">$</span><span class="va">gene</span><span class="op">]</span></span></code></pre></div>
<p>To visualise the expression of the selected genes, use the
<code>draw_trajectory_heatmap</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_trajectory_heatmap.html">draw_trajectory_heatmap</a></span><span class="op">(</span><span class="va">expr_sel</span>, <span class="va">traj</span><span class="op">$</span><span class="va">time</span>, <span class="va">group_name</span><span class="op">)</span></span></code></pre></div>
<p><img src="ginhoux_files/figure-html/visualise_tafs-1.png" width="700"></p>
<p>Finally, these genes can also be grouped into modules as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modules</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_modules.html">extract_modules</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dynutils/man/scale_quantile.html" class="external-link">scale_quantile</a></span><span class="op">(</span><span class="va">expr_sel</span><span class="op">)</span>, <span class="va">traj</span><span class="op">$</span><span class="va">time</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_trajectory_heatmap.html">draw_trajectory_heatmap</a></span><span class="op">(</span><span class="va">expr_sel</span>, <span class="va">traj</span><span class="op">$</span><span class="va">time</span>, <span class="va">group_name</span>, <span class="va">modules</span><span class="op">)</span></span></code></pre></div>
<p><img src="ginhoux_files/figure-html/moduled_tafs-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Robrecht Cannoodt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
