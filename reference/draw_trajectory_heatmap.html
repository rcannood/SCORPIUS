<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="draw_trajectory_heatmap draws a heatmap in which the samples
are ranked according their position in an inferred trajectory. In addition, the progression groups and
feature modules can be passed along to further enhance the visualisation."><title>Draw time-series heatmap — draw_trajectory_heatmap • SCORPIUS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Draw time-series heatmap — draw_trajectory_heatmap"><meta property="og:description" content="draw_trajectory_heatmap draws a heatmap in which the samples
are ranked according their position in an inferred trajectory. In addition, the progression groups and
feature modules can be passed along to further enhance the visualisation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SCORPIUS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/anndata.html">Running SCORPIUS on an AnnData object</a>
    <a class="dropdown-item" href="../articles/ginhoux.html">Investigating dendritic cell maturation in dendritic cell progenitors</a>
    <a class="dropdown-item" href="../articles/seurat.html">Running SCORPIUS on a Seurat object</a>
    <a class="dropdown-item" href="../articles/simulated-data.html">Trajectory inference from simulated data</a>
    <a class="dropdown-item" href="../articles/singlecellexperiment.html">Running SCORPIUS on a SingleCellExperiment object</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rcannood/SCORPIUS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Draw time-series heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/rcannood/SCORPIUS/blob/HEAD/R/plotting.R" class="external-link"><code>R/plotting.R</code></a></small>
      <div class="d-none name"><code>draw_trajectory_heatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>draw_trajectory_heatmap</code> draws a heatmap in which the samples
are ranked according their position in an inferred trajectory. In addition, the progression groups and
feature modules can be passed along to further enhance the visualisation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">draw_trajectory_heatmap</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">time</span>,</span>
<span>  progression_group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  modules <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_labels_row <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_labels_col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale_features <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progression_group_palette <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A numeric matrix or a data frame with one row per sample and one column per feature.</p></dd>


<dt>time</dt>
<dd><p>A numeric vector containing the inferred time points of each sample along a trajectory.</p></dd>


<dt>progression_group</dt>
<dd><p><code>NULL</code> or a vector (or factor) containing the groupings of the samples (default <code>NULL</code>).</p></dd>


<dt>modules</dt>
<dd><p><code>NULL</code> or a data frame as returned by <code><a href="extract_modules.html">extract_modules</a></code>.</p></dd>


<dt>show_labels_row</dt>
<dd><p><code>TRUE</code> if the labels of the rows are to be plotted (default <code>FALSE</code>).</p></dd>


<dt>show_labels_col</dt>
<dd><p><code>TRUE</code> if the labels of the cols are to be plotted (default <code>FALSE</code>).</p></dd>


<dt>scale_features</dt>
<dd><p><code>TRUE</code> if the values of each feature is to be scaled (default <code>TRUE</code>).</p></dd>


<dt>progression_group_palette</dt>
<dd><p>A named vector palette for the progression group.</p></dd>


<dt>...</dt>
<dd><p>Optional arguments to <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The output of the <code><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Generate a dataset</span></span></span>
<span class="r-in"><span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_dataset.html">generate_dataset</a></span><span class="op">(</span>num_genes<span class="op">=</span><span class="fl">500</span>, num_samples<span class="op">=</span><span class="fl">300</span>, num_groups<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">expression</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="va">expression</span></span></span>
<span class="r-in"><span><span class="va">space</span> <span class="op">&lt;-</span> <span class="fu"><a href="reduce_dimensionality.html">reduce_dimensionality</a></span><span class="op">(</span><span class="va">expression</span>, ndim<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="va">dataset</span><span class="op">$</span><span class="va">sample_info</span><span class="op">$</span><span class="va">group_name</span></span></span>
<span class="r-in"><span><span class="va">traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="infer_trajectory.html">infer_trajectory</a></span><span class="op">(</span><span class="va">space</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">traj</span><span class="op">$</span><span class="va">time</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gimp</span> <span class="op">&lt;-</span> <span class="fu"><a href="gene_importances.html">gene_importances</a></span><span class="op">(</span><span class="va">expression</span>, <span class="va">traj</span><span class="op">$</span><span class="va">time</span>, num_permutations <span class="op">=</span> <span class="fl">0</span>, ntree <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gene_sel</span> <span class="op">&lt;-</span> <span class="va">gimp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">expr_sel</span> <span class="op">&lt;-</span> <span class="va">expression</span><span class="op">[</span>,<span class="va">gene_sel</span><span class="op">$</span><span class="va">gene</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Draw a time series heatmap</span></span></span>
<span class="r-in"><span><span class="fu">draw_trajectory_heatmap</span><span class="op">(</span><span class="va">expr_sel</span>, <span class="va">time</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw_trajectory_heatmap-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Also show the progression groupings</span></span></span>
<span class="r-in"><span><span class="fu">draw_trajectory_heatmap</span><span class="op">(</span><span class="va">expr_sel</span>, <span class="va">time</span>, progression_group<span class="op">=</span><span class="va">groups</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw_trajectory_heatmap-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Use a different palette</span></span></span>
<span class="r-in"><span><span class="fu">draw_trajectory_heatmap</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">expr_sel</span>, <span class="va">time</span>, progression_group<span class="op">=</span><span class="va">groups</span>,</span></span>
<span class="r-in"><span>  progression_group_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"Set2"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Group "</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw_trajectory_heatmap-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Group the genes into modules and visualise the modules in a heatmap</span></span></span>
<span class="r-in"><span><span class="va">modules</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract_modules.html">extract_modules</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/dynutils/man/scale_quantile.html" class="external-link">scale_quantile</a></span><span class="op">(</span><span class="va">expr_sel</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">draw_trajectory_heatmap</span><span class="op">(</span><span class="va">expr_sel</span>, <span class="va">time</span>, progression_group<span class="op">=</span><span class="va">groups</span>, modules<span class="op">=</span><span class="va">modules</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="draw_trajectory_heatmap-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robrecht Cannoodt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

